/*
  <:copyright-BRCM:2015:proprietary:standard
  
     Copyright (c) 2015 Broadcom 
     All Rights Reserved
  
   This program is the proprietary software of Broadcom and/or its
   licensors, and may only be used, duplicated, modified or distributed pursuant
   to the terms and conditions of a separate, written license agreement executed
   between you and Broadcom (an "Authorized License").  Except as set forth in
   an Authorized License, Broadcom grants no license (express or implied), right
   to use, or waiver of any kind with respect to the Software, and Broadcom
   expressly reserves all rights in and to the Software and all intellectual
   property rights therein.  IF YOU HAVE NO AUTHORIZED LICENSE, THEN YOU HAVE
   NO RIGHT TO USE THIS SOFTWARE IN ANY WAY, AND SHOULD IMMEDIATELY NOTIFY
   BROADCOM AND DISCONTINUE ALL USE OF THE SOFTWARE.
  
   Except as expressly set forth in the Authorized License,
  
   1. This program, including its structure, sequence and organization,
      constitutes the valuable trade secrets of Broadcom, and you shall use
      all reasonable efforts to protect the confidentiality thereof, and to
      use this information only in connection with your use of Broadcom
      integrated circuit products.
  
   2. TO THE MAXIMUM EXTENT PERMITTED BY LAW, THE SOFTWARE IS PROVIDED "AS IS"
      AND WITH ALL FAULTS AND BROADCOM MAKES NO PROMISES, REPRESENTATIONS OR
      WARRANTIES, EITHER EXPRESS, IMPLIED, STATUTORY, OR OTHERWISE, WITH
      RESPECT TO THE SOFTWARE.  BROADCOM SPECIFICALLY DISCLAIMS ANY AND
      ALL IMPLIED WARRANTIES OF TITLE, MERCHANTABILITY, NONINFRINGEMENT,
      FITNESS FOR A PARTICULAR PURPOSE, LACK OF VIRUSES, ACCURACY OR
      COMPLETENESS, QUIET ENJOYMENT, QUIET POSSESSION OR CORRESPONDENCE
      TO DESCRIPTION. YOU ASSUME THE ENTIRE RISK ARISING OUT OF USE OR
      PERFORMANCE OF THE SOFTWARE.
  
   3. TO THE MAXIMUM EXTENT PERMITTED BY LAW, IN NO EVENT SHALL BROADCOM OR
      ITS LICENSORS BE LIABLE FOR (i) CONSEQUENTIAL, INCIDENTAL, SPECIAL,
      INDIRECT, OR EXEMPLARY DAMAGES WHATSOEVER ARISING OUT OF OR IN ANY
      WAY RELATING TO YOUR USE OF OR INABILITY TO USE THE SOFTWARE EVEN
      IF BROADCOM HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES;
      OR (ii) ANY AMOUNT IN EXCESS OF THE AMOUNT ACTUALLY PAID FOR THE
      SOFTWARE ITSELF OR U.S. $1, WHICHEVER IS GREATER. THESE LIMITATIONS
      SHALL APPLY NOTWITHSTANDING ANY FAILURE OF ESSENTIAL PURPOSE OF ANY
      LIMITED REMEDY.
  :>
*/

/****************************************************************************
 *
 * pon_gpon_init.c -- Bcm Pon driver: init sequence for GPON mode
 *
 * Description:
 *	Built from initialization script of VLSI team
 *
 * Authors: Fuguo Xu, Akiva Sadovski
 *
 * $Revision: 1.1 $
 *
 *
 ****************************************************************************/

#include <linux/delay.h>
#include "pon_drv.h"
#include "gpon_pattern_gearbox_ag.h"
#include "ru_types.h"


/*
 *   Ugly way to translate physical to virtual for one particular block - WAN TOP
 */
#define WAN_TOP_WRITE_32(a, r)   {uint32_t val=r; unsigned long _a=(0xffffff8000002000 + (a - 0x80144000)); /*printk("--> 0x%lx 0x%x\n",_a, val);*/ WRITE_32(_a, val);}

static void gpon_wan_top_init(void)
{
/*
 #Starting initSerdes()
  dw 0x80144038  # 0x0
  sw 0x80144034 0x8000 
*/
  WAN_TOP_WRITE_32(0x80144034, 0x8000);

/*  
  dw 0x80144038  # 0x5c00013
  dw 0x80144038  # 0x5c00013
*/

/*
 #Rescal status: 0x5c00013
  sw 0xff8026bc 0x0 
  dw 0xff8026bc  # 0x0
*/
#if 0
 WAN_TOP_WRITE_32(0xff8026bc, 0x0);   /* I cannot believe that this addr is related to rescale ... AkivaS */
#endif
/*
 #beginTransaction
  dw 0x80144014  # 0x53c080
 #fieldWrite NGPON_GEARBOX_RX_CTL_0[cfNGponGboxRxFrcHunt], 0x0
  sw 0x80144014 0x534080 
  dw 0x80144014   # 0x534080
 #fieldWrite NGPON_GEARBOX_RX_CTL_0[cfNGponGboxRxOutDataFlip], 0x0
  sw 0x80144014 0x530080 
 #endTransaction
  sw 0x80144014 0x530080 
  dw 0x80144024   # 0x80060
*/
/*
 * Set NGPON_GEARBOX_RX_CTL_0: cfNGponGboxRxFrcHunt = 0, cfNGponGboxRxOutDataFlip = 0
 */
 WAN_TOP_WRITE_32(0x80144014, 0x534080);
 WAN_TOP_WRITE_32(0x80144014, 0x530080);   /* Probably one write is enough */
/*
 #fieldWrite NGPON_GEARBOX_TX_CTL[cfNGponGboxTxEn], 0x1
  sw 0x80144024 0x80061 
  dw 0x80144004   # 0x10300
*/
/*
 *   Set NGPON_GEARBOX_TX_CTL: cfNGponGboxTxEn = 1
 */
 WAN_TOP_WRITE_32(0x80144024, 0x80061);
/*
 #fieldWrite GPON_GEARBOX_0[cr_xgwan_top_wan_misc_gpon_gearbox_fifo_cfg_0_rx_16bit_order], 0x1
  sw 0x80144004 0x4010300 
  dw 0x80144004   # 0x4010300
 #fieldWrite GPON_GEARBOX_0[cr_xgwan_top_wan_misc_gpon_gearbox_fifo_cfg_0_tx_16bit_order], 0x1
  sw 0x80144004 0x5010300 
*/
/*
 *  Set GPON_GEARBOX_0: cr_xgwan_top_wan_misc_gpon_gearbox_fifo_cfg_0_rx_16bit_order=1, cr_xgwan_top_wan_misc_gpon_gearbox_fifo_cfg_0_tx_16bit_order=1
 */
  WAN_TOP_WRITE_32(0x80144004,0x4010300);
  WAN_TOP_WRITE_32(0x80144004,0x5010300);

/*
  dw 0x80144010   # 0x1c00
  sw 0x80144010 0x3001c00 
*/
/*
 * Set WAN_TOP_GPON_GEARBOX_2
 */  
  WAN_TOP_WRITE_32(0x80144010,0x3001c00);

/*
  sw 0x80144048 0x0 
  dw 0x80144048   # 0x0
 #fieldWrite WAN_TOP_MISC_2[cr_xgwan_top_wan_misc_pmd_por_h_rstb], 0x0
  sw 0x80144048 0x0 
*/
/*
 * Set WAN_TOP_MISC_2: cr_xgwan_top_wan_misc_pmd_por_h_rstb=0x0
 */
  WAN_TOP_WRITE_32(0x80144048,0x0);

/*
 #beginTransaction
  dw 0x80144050   # 0x0
 #fieldWrite WAN_SERDES_PLL_CTL[cfg_pll1_lcref_sel], 0x0
  sw 0x80144050 0x0 
  dw 0x80144050   # 0x0
 #fieldWrite WAN_SERDES_PLL_CTL[cfg_pll1_refin_en], 0x1
  sw 0x80144050 0x100 
  dw 0x80144050   # 0x100
 #fieldWrite WAN_SERDES_PLL_CTL[cfg_pll0_lcref_sel], 0x1
  sw 0x80144050 0x104 
  dw 0x80144050   # 0x104
 #fieldWrite WAN_SERDES_PLL_CTL[cfg_pll0_refin_en], 0x1
  sw 0x80144050 0x105 
 #endTransaction
*/
/*
 *  Set WAN_SERDES_PLL_CTL: cfg_pll1_lcref_sel=0, cfg_pll1_refin_en=1, 
 *                          cfg_pll0_lcref_sel=1, cfg_pll0_refin_en=1
 */
  WAN_TOP_WRITE_32(0x80144050,0x0);
  WAN_TOP_WRITE_32(0x80144050,0x100);
  WAN_TOP_WRITE_32(0x80144050,0x104);
  WAN_TOP_WRITE_32(0x80144050,0x105);

/*
  sw 0x80144050 0x105 
  dw 0x80144048   # 0x0
 #fieldWrite WAN_TOP_MISC_2[cr_xgwan_top_wan_misc_pmd_por_h_rstb], 0x1
  sw 0x80144048 0x20 
  dw 0x80144048   # 0x20
 #fieldWrite WAN_TOP_MISC_2[cr_xgwan_top_wan_misc_pmd_core_1_dp_h_rstb], 0x1
  sw 0x80144048 0x30 
  dw 0x80144048   # 0x30
 #fieldWrite WAN_TOP_MISC_2[cr_xgwan_top_wan_misc_pmd_core_0_dp_h_rstb], 0x1
  sw 0x80144048 0x38 
  dw 0x80144048   # 0x38
 #fieldWrite WAN_TOP_MISC_2[cr_xgwan_top_wan_misc_pmd_ln_h_rstb], 0x1
  sw 0x80144048 0x3c 
  dw 0x80144048   # 0x3c
 #fieldWrite WAN_TOP_MISC_2[cr_xgwan_top_wan_misc_pmd_ln_dp_h_rstb], 0x1
  sw 0x80144048 0x3e  
*/
/*
 *  Set WAN_TOP_MISC_2: cr_xgwan_top_wan_misc_pmd_por_h_rstb=1, cr_xgwan_top_wan_misc_pmd_core_1_dp_h_rstb=1
 *                      cr_xgwan_top_wan_misc_pmd_core_0_dp_h_rstb=1, cr_xgwan_top_wan_misc_pmd_ln_h_rstb=1
 *                      cr_xgwan_top_wan_misc_pmd_ln_dp_h_rstb=1
 */
  WAN_TOP_WRITE_32(0x80144048,0x20);  
  WAN_TOP_WRITE_32(0x80144048,0x30);  
  WAN_TOP_WRITE_32(0x80144048,0x38);  
  WAN_TOP_WRITE_32(0x80144048,0x3c);  
  WAN_TOP_WRITE_32(0x80144048,0x3e);  

/*
  sw 0x80144040 0x0 
  dw 0x80144040   # 0x0
 #fieldWrite WAN_TOP_MISC_0[cr_xgwan_top_wan_misc_refin_en], 0x1
  sw 0x80144040 0x2 
*/
/*
 *   Set WAN_TOP_WAN_TOP_MISC_0 to 0
 */
  WAN_TOP_WRITE_32(0x80144040,0x2);

/*
  sw 0x80144044 0x0 
*/
/*
 *   Set WAN_TOP_WAN_TOP_MISC_1 to 0
 */
  WAN_TOP_WRITE_32(0x80144044,0x0);
/*
 #beginTransaction
  dw 0x80144048   # 0x3e
 #fieldWrite WAN_TOP_MISC_2[cr_xgwan_top_wan_misc_pmd_rx_osr_mode], 0x0
  sw 0x80144048 0x3e 
  dw 0x80144048   # 0x3e
 #fieldWrite WAN_TOP_MISC_2[cr_xgwan_top_wan_misc_pmd_tx_osr_mode], 0x1
  sw 0x80144048 0x103e 
 #endTransaction
  sw 0x80144048 0x103e 
*/
/*
 *   Set WAN_TOP_WAN_TOP_MISC_2: cr_xgwan_top_wan_misc_pmd_rx_osr_mode=0, cr_xgwan_top_wan_misc_pmd_tx_osr_mode=1
 */
  WAN_TOP_WRITE_32(0x80144048,0x3e);
  WAN_TOP_WRITE_32(0x80144048,0x103e);

/*
 #beginTransaction
  sw 0x8014404c 0x0 
  dw 0x8014404c   # 0x0
 #fieldWrite WAN_TOP_MISC_3[cr_xgwan_top_wan_misc_wan_cfg_laser_oe], 0x1
  sw 0x8014404c 0x80    //c8  !!!!! Critical 
 #endTransaction
  sw 0x8014404c 0x80 
*/
/*
 *  Set WAN_TOP_MISC_3: cr_xgwan_top_wan_misc_wan_cfg_laser_oe=1
 */
  WAN_TOP_WRITE_32(0x8014404c,0x0);
  WAN_TOP_WRITE_32(0x8014404c,0xC8);
/*
  sw 0x80144058 0x0 
*/
/*
 *  Zero WAN_TOP_WAN_SERDES_PRAM_CTL -
 */
  WAN_TOP_WRITE_32(0x80144058,0x0); 
}


static void set_serdes_reg(uint32_t addr, uint32_t masked_inv_val)
{
  WAN_TOP_WRITE_32(0x80144060, (0x8000000 | addr));
  WAN_TOP_WRITE_32(0x80144064, masked_inv_val);
  WAN_TOP_WRITE_32(0x8014405c,0x3);
  udelay(1);
  WAN_TOP_WRITE_32(0x8014405c,0x0);
}



static void gpon_serdes_init (void)
{
/*
 #writePONSerdesReg (0x0800) 0xd0b9 0x0000 0x0004
  sw 0x80144060 0x800d0b9   
  sw 0x80144064 0xfffb   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10004
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b9, 0xfffb);
/*
 #writePONSerdesReg (0x0900) 0xd0b9 0x0004 0x0004
  sw 0x80144060 0x900d0b9 
  sw 0x80144064 0x4fffb 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10004
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0x100d0b9, 0x4fffb);

/*
 #writePONSerdesReg (0x0800) 0xd0b1 0x0080 0x0080
  sw 0x80144060 0x800d0b1 
  sw 0x80144064 0x80ff7f  
  sw 0x8014405c 0x3    
  dw 0x80144068   # 0x18001
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b1, 0x80ff7f);

/*
 #writePONSerdesReg (0x0800) 0xd0b1 0x0000 0x0040
  sw 0x80144060 0x800d0b1 
  sw 0x80144064 0xffbf 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x18081
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b1, 0xffbf);
/*
 #writePONSerdesReg (0x0800) 0xd0b4 0x0300 0x0300
  sw 0x80144060 0x800d0b4 
  sw 0x80144064 0x300fcff 
  sw 0x8014405c 0x3    
  dw 0x80144068   # 0x10077
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b4, 0x300fcff);
/*
 #writePONSerdesReg (0x0800) 0xd0b4 0x2000 0x3000
  sw 0x80144060 0x800d0b4 
  sw 0x80144064 0x2000cfff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10377
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b4, 0x2000cfff);

/*
 #writePONSerdesReg  (0x0800) 0xd0b4 0x4000 0x4000
  sw 0x80144060 0x800d0b4 
  sw 0x80144064 0x4000bfff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x12377     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b4, 0x4000bfff);
/*
 #writePONSerdesReg  (0x0800) 0xd0b7 0x432c 0xffff 
  sw 0x80144060 0x800d0b7 
  sw 0x80144064 0x432c0000      
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b7, 0x432c0000);
/*
 #writePONSerdesReg  (0x0800) 0xd0b8 0x0000 0x0003 
  sw 0x80144060 0x800d0b8 
  sw 0x80144064 0xfffc 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b8, 0xfffc);
/*
 #writePONSerdesReg  (0x0800) 0xd0b8 0x0000 0x0004 
  sw 0x80144060 0x800d0b8 
  sw 0x80144064 0xfffb 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b8, 0xfffb);
/*
 #writePONSerdesReg  (0x0800) 0xd0b8 0x0c70 0x3ff0 
  sw 0x80144060 0x800d0b8 
  sw 0x80144064 0xc70c00f 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b8, 0xc70c00f);
/*
 #writePONSerdesReg  (0x0800) 0xd0b6 0x0001 0x0001 
  sw 0x80144060 0x800d0b6 
  sw 0x80144064 0x1fffe   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x145c0     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b6, 0x1fffe);
/*
 #writePONSerdesReg  (0x0800) 0xd0b8 0x8000 0x8000 
  sw 0x80144060 0x800d0b8 
  sw 0x80144064 0x80007fff      
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10c70     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b8, 0x80007fff);
/*
 #writePONSerdesReg  (0x0800) 0xd0b8 0x4000 0x4000 
  sw 0x80144060 0x800d0b8 
  sw 0x80144064 0x4000bfff      
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x18c70     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b8, 0x4000bfff);
/*
 #writePONSerdesReg  (0x0800) 0xd0b8 0x0000 0x0008 
  sw 0x80144060 0x800d0b8 
  sw 0x80144064 0xfff7 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x1cc70     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0b8, 0xfff7);

/*
 #writePONSerdesReg  (0x0800) 0xd08d 0x0000 0x0001 
  sw 0x80144060 0x800d08d 
  sw 0x80144064 0xfffe 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd08d, 0xfffe);
/*
 #writePONSerdesReg  (0x0800) 0xd08d 0x0000 0x0002 
  sw 0x80144060 0x800d08d 
  sw 0x80144064 0xfffd 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd08d, 0xfffd);
/*
 #writePONSerdesReg  (0x0800) 0xd050 0x0002 0x0007 
  sw 0x80144060 0x800d050 
  sw 0x80144064 0x2fff8   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd050, 0x2fff8);
/*
 #writePONSerdesReg  (0x0800) 0xd001 0x0004 0x0004 
  sw 0x80144060 0x800d001 
  sw 0x80144064 0x4fffb   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10004     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd001, 0x4fffb);
/*
 #writePONSerdesReg  (0x0800) 0xd003 0x0000 0x0300 
  sw 0x80144060 0x800d003 
  sw 0x80144064 0xfcff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x100f0     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd003, 0xfcff);
/*
 #writePONSerdesReg  (0x0800) 0xd001 0x0000 0x0040 
  sw 0x80144060 0x800d001 
  sw 0x80144064 0xffbf 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10004     
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd001, 0xffbf);
/*
 #writePONSerdesReg  (0x0800) 0xd017 0x0000 0x000f  
  sw 0x80144060 0x800d017 
  sw 0x80144064 0xfff0 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd017, 0xfff0);
/*
 #writePONSerdesReg  (0x0800) 0xd017 0x0000 0x0f00  
  sw 0x80144060 0x800d017 
  sw 0x80144064 0xf0ff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd017, 0xf0ff);
/*
 #writePONSerdesReg  (0x0800) 0xd017 0x0000 0x3000  
  sw 0x80144060 0x800d017 
  sw 0x80144064 0xcfff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd017, 0xcfff);
/*
 #writePONSerdesReg  (0x0800) 0xd017 0x0000 0xc000  
  sw 0x80144060 0x800d017 
  sw 0x80144064 0x3fff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd017, 0x3fff);
/*
 #writePONSerdesReg  (0x0800) 0xd001 0x0000 0x0080  
  sw 0x80144060 0x800d001 
  sw 0x80144064 0xff7f 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10004      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd001, 0xff7f);
/*
 #writePONSerdesReg  (0x0800) 0xd002 0x02b2 0xffff  
  sw 0x80144060 0x800d002 
  sw 0x80144064 0x2b20000 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10690      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd002, 0x2b20000);
/*
 #writePONSerdesReg  (0x0800) 0xd018 0x0000 0x000f  
  sw 0x80144060 0x800d018 
  sw 0x80144064 0xfff0 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10011      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd018, 0xfff0);
/*
 #writePONSerdesReg  (0x0800) 0xd018 0x0000 0x0300  
  sw 0x80144060 0x800d018 
  sw 0x80144064 0xfcff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10010      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd018, 0xfcff);
/*
 #writePONSerdesReg  (0x0800) 0xd001 0x0001 0x0001  
  sw 0x80144060 0x800d001 
  sw 0x80144064 0x1fffe   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10004      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd001, 0x1fffe);
/*
 #writePONSerdesReg  (0x0800) 0xd003 0x0000 0x0002  
  sw 0x80144060 0x800d003 
  sw 0x80144064 0xfffd 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x100f0      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd003,0xfffd);
/*
 #writePONSerdesReg  (0x0800) 0xd003 0x00f0 0x00f0  
  sw 0x80144060 0x800d003 
  sw 0x80144064 0xf0ff0f  
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x100f0      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd003, 0xf0ff0f);
/*
 #writePONSerdesReg  (0x0800) 0xd041 0x0007 0x000f  
  sw 0x80144060 0x800d041 
  sw 0x80144064 0x7fff0   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd041, 0x7fff0);
/*
 #writePONSerdesReg  (0x0800) 0xd042 0x0003 0x0007  
  sw 0x80144060 0x800d042 
  sw 0x80144064 0x3fff8   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd042, 0x3fff8);
/*
 #writePONSerdesReg  (0x0800) 0xd02b 0x0000 0x3e00  
  sw 0x80144060 0x800d02b 
  sw 0x80144064 0xc1ff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd02b, 0xc1ff);
/*
 #writePONSerdesReg  (0x0800) 0xd02b 0x0100 0x01ff  
  sw 0x80144060 0x800d02b 
  sw 0x80144064 0x100fe00 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd02b, 0x100fe00);
/*
 #writePONSerdesReg  (0x0800) 0xd02b 0x8000 0x8000  
  sw 0x80144060 0x800d02b 
  sw 0x80144064 0x80007fff      
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10100      
  sw 0x8014405c 0x0 
  sw 0x80144060 0x800d00a 
  sw 0x8014405c 0x2 
  dw 0x80144068   # 0x10000      
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
 #readPONSerdesReg (0x0800) 0xd00a 0x0000       
*/
 set_serdes_reg(0xd02b, 0x80007fff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x4000 0x7000  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x40008fff      
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000  
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x40008fff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0400 0x0400  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x400fbff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x400fbff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0001 0x007f  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x1ff80 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14400      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x1ff80);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14401      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004,0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200   
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601    
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0200 0x0200  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x200fdff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
  sw 0x80144060 0x800d00a 
  sw 0x8014405c 0x2 
  dw 0x80144068   # 0x10000      
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
 #readPONSerdesReg (0x0800) 0xd00a   # 0x0000       
*/
 set_serdes_reg(0xd004, 0x200fdff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x2000 0x7000  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x20008fff      
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x20008fff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0400 0x0400  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x400fbff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x12601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004, 0x400fbff);
/*
 #writePONSerdesReg  (0x0800) 0xd004 0x0001 0x007f  
  sw 0x80144060 0x800d004 
  sw 0x80144064 0x1ff80   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x12601      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd004,0x1ff80);
/*
 #writePONSerdesReg  (0x0800) 0xd080 0x4000 0x4000  
  sw 0x80144060 0x800d080 
  sw 0x80144064 0x4000bfff      
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd080, 0x4000bfff);
/* 
#writePONSerdesReg  (0x0800) 0xd080 0x0000 0x000f  
  sw 0x80144060 0x800d080 
  sw 0x80144064 0xfff0 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd080, 0xfff0);
/*
 #writePONSerdesReg  (0x0800) 0xd080 0x8000 0x8000  
  sw 0x80144060 0x800d080 
  sw 0x80144064 0x80007fff      
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x14000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd080, 0x80007fff);
/*
 #writePONSerdesReg  (0x0800) 0xd080 0x0010 0x00f0  
  sw 0x80144060 0x800d080 
  sw 0x80144064 0x10ff0f  
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x1c000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd080, 0x10ff0f);
/* 
#writePONSerdesReg  (0x0800) 0xd07c 0x0100 0x0100  
  sw 0x80144060 0x800d07c 
  sw 0x80144064 0x100feff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd07c, 0x100feff);
/*
 #writePONSerdesReg  (0x0800) 0xd0a1 0x0001 0x0001  
  sw 0x80144060 0x800d0a1 
  sw 0x80144064 0x1fffe   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x1007e      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0a1, 0x1fffe);
/* 
#writePONSerdesReg  (0x0800) 0xd0a1 0x0006 0x000e  
  sw 0x80144060 0x800d0a1 
  sw 0x80144064 0x6fff1   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x1007f      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0a1, 0x6fff1);
/*
 #writePONSerdesReg  (0x0800) 0xd0a1 0x0020 0x0070  
  sw 0x80144060 0x800d0a1 
  sw 0x80144064 0x20ff8f  
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10077      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0a1, 0x20ff8f);
/* 
#writePONSerdesReg  (0x0800) 0xd092 0x0002 0x0007  
  sw 0x80144060 0x800d092 
  sw 0x80144064 0x2fff8   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x1a807      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd092, 0x2fff8);
/*
 #writePONSerdesReg  (0x0800) 0xd154 0x2000 0x2000  
  sw 0x80144060 0x800d154 
  sw 0x80144064 0x2000dfff      
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd154, 0x2000dfff);

/*
  dw 0x80144094   # 0x3          
  sw 0x80144060 0x800d01e 
  sw 0x8014405c 0x2 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
/*
 #readPONSerdesReg (0x0800) 0xd01e   # 0x0000       
  sw 0x80144060 0x800d01e 
  sw 0x8014405c 0x2 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
 #readPONSerdesReg (0x0800) 0xd01a   # 0x0000     
  sw 0x80144060 0x800d01a 
  sw 0x8014405c 0x2 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
 #readPONSerdesReg (0x0800) 0xd01a   # 0x0000       
*/
/*
 #writePONSerdesReg  (0x0800) 0xd081 0x0002 0x0002  
  sw 0x80144060 0x800d081 
  sw 0x80144064 0x2fffd 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd081, 0x2fffd);

/*
 #beginTransaction                                   
  dw 0x80144014   # 0x530080     
 #fieldWrite NGPON_GEARBOX_RX_CTL_0[cfNGponGboxRxFifotr], 0x8
  sw 0x80144014 0x8530080 
  dw 0x80144014   # 0x8530080    
 #fieldWrite NGPON_GEARBOX_RX_CTL_0[cfNGponGboxRxFifoLd], 0x1
  sw 0x80144014 0x8530090 
  dw 0x80144014   # 0x8530090    
 #fieldWrite NGPON_GEARBOX_RX_CTL_0[cfNGponGboxRxSerDFlip], 0x1
  sw 0x80144014 0x85300d0 
  dw 0x80144014   # 0x85300d0    
 #fieldWrite NGPON_GEARBOX_RX_CTL_0[cfNGponGboxRxMode0x1
  sw 0x80144014 0x85300d4 
  dw 0x80144024   # 0x80061      
 #fieldWrite NGPON_GEARBOX_TX_CTL[cfNGponGboxTxFifoDadPtr], 0x8
  sw 0x80144024 0x80061 
  dw 0x80144024   # 0x80061      
 #fieldWrite NGPON_GEARBOX_TX_CTL[cfNGponGboxTxFifoVlrLd], 0x1
  sw 0x80144024 0x80065 
  dw 0x80144024   # 0x80065      
 #fieldWrite NGPON_GEARBOX_TX_CTL[cfNGponGboxTxFifoPt], 0x1
  sw 0x80144024 0x80067 
  dw 0x80144024   # 0x80067      
 #fieldWrite NGPON_GEARBOX_TX_CTL[cfNGponGboxTxFifoVlf], 0x1e
  sw 0x80144024 0x81e67 
 #endTransaction                                     
  sw 0x80144014 0x85300d4 
  sw 0x80144024 0x81e67 
*/
/*
 *  Set NGPON_GEARBOX_RX_CTL_0:
 * cfNGponGboxRxFifotr=8
 * cfNGponGboxRxFifoLd=1
 * cfNGponGboxRxSerDFlip=1
 * cfNGponGboxRxMode=1
 */
 WAN_TOP_WRITE_32(0x80144014, 0x8530080);
 WAN_TOP_WRITE_32(0x80144014, 0x8530090);
 WAN_TOP_WRITE_32(0x80144014, 0x85300d0);
 WAN_TOP_WRITE_32(0x80144014, 0x85300d4);
/*
 *  Set NGPON_GEARBOX_TX_CTL:
 * cfNGponGboxTxFifoDadPtr=8
 * cfNGponGboxTxFifoVlrLd=1
 * cfNGponGboxTxFifoPt=1
 * cfNGponGboxTxFifoVlf=1e
 */
 WAN_TOP_WRITE_32(0x80144024,0x80061);
 WAN_TOP_WRITE_32(0x80144024,0x80065);
 WAN_TOP_WRITE_32(0x80144024,0x80067);
 WAN_TOP_WRITE_32(0x80144024,0x81e67);
/*
  sw 0x80144014 0x85300d4 
*/
 WAN_TOP_WRITE_32(0x80144014,0x85300d4);
/*
  sw 0x80144024 0x81e67 
*/
 WAN_TOP_WRITE_32(0x80144024,0x81e67);
/*
 #writePONSerdesReg  (0x0800) 0xd0d1 0x000a 0x000e  
  sw 0x80144060 0x800d0d1 
  sw 0x80144064 0xafff1 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x1002a      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0d1, 0xafff1);
/*
 #writePONSerdesReg  (0x0800) 0xd0e1 0x0000 0x000f  
  sw 0x80144060 0x800d0e1 
  sw 0x80144064 0x0
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x1000a      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0e1, 0x0);  /* Vitaly: do not enable PRBS */
/*
 #writePONSerdesReg  (0x0800) 0xd0a0 0x0000 0xffff  
  sw 0x80144060 0x800d0a0 
  sw 0x80144064 0x0 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0a0,0x0);
/*
 #writePONSerdesReg  (0x0800) 0xd0e0 0x0000 0x0001  
  sw 0x80144060 0x800d0e0 
  sw 0x80144064 0xfffe 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x1e000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0e0, 0xfffe);
/*
 #writePONSerdesReg  (0x0800) 0xd0e1 0x0001 0x0001  
  sw 0x80144060 0x800d0e1 
  sw 0x80144064 0x0   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x1000a      
  sw 0x8014405c 0x0 
*/
/* set_serdes_reg(0xd0e1, 0x0);*/ /* -Vitaly: do not enable PRBS! */
/*
 #writePONSerdesReg  (0x0800) 0xd070 0x2000 0x7000  
  sw 0x80144060 0x800d070 
  sw 0x80144064 0x20008fff      
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x12000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd070, 0x20008fff);
/*
 #writePONSerdesReg  (0x0800) 0xd0e2 0x0000 0x0001  
  sw 0x80144060 0x800d0e2 
  sw 0x80144064 0xfffe 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10002      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0e2, 0xfff8); /* 0xfffe -> Mike's original -  Vitaly changed */
/*
 #writePONSerdesReg  (0x0800) 0xd070 0x0000 0x0004  
  sw 0x80144060 0x800d070 
  sw 0x80144064 0xfffb 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x12000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd070, 0xfffb);
/*
 #writePONSerdesReg  (0x0800) 0xd070 0x0000 0x0002  
  sw 0x80144060 0x800d070 
  sw 0x80144064 0xfffd 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x12000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd070, 0xfffd);
/*
 #writePONSerdesReg  (0x0800) 0xd070 0x0000 0x0001  
  sw 0x80144060 0x800d070 
  sw 0x80144064 0xfffe 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x12000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd070, 0xfffe);
/*
 #writePONSerdesReg  (0x0800) 0xd0e4 0x0000 0x0001 
  sw 0x80144060 0x800d0e4 
  sw 0x80144064 0x0 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
  dw 0x80144048   # 0x103e       
*/
 set_serdes_reg(0xd0e4, 0x0); /*  Vitaly changed to 0 */
/*
 #fieldWrite WAN_TOP_MISC_2[cr_xgwan_top_wan_misc_pmd_disable], 0x0
  sw 0x80144048 0x103e 
*/
  WAN_TOP_WRITE_32(0x80144048,0x103e);
/*
 #writePONSerdesReg  (0x0800) 0xd0a2 0x0000 0x6000  
  sw 0x80144060 0x800d0a2 
  sw 0x80144064 0x9fff 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x1000c      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0a2, 0x9fff);
/*
 #writePONSerdesReg  (0x0800) 0xd0a2 0x000d 0x000f  
  sw 0x80144060 0x800d0a2 
  sw 0x80144064 0xdfff0   
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x1000c      
  sw 0x8014405c 0x0 
  dw 0x80144048   # 0x103e   
*/
 set_serdes_reg(0xd0a2, 0xdfff0);
/*    
 #fieldWrite WAN_TOP_MISC_2[cr_xgwan_top_wan_misc_pmd_disable], 0x0
  sw 0x80144048 0x103e 
*/
  WAN_TOP_WRITE_32(0x80144048,0x103e);
/*
 #writePONSerdesReg  (0x0800) 0xd00d 0x0000 0xffff  
  sw 0x80144060 0x800d00d 
  sw 0x80144064 0x0 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
  sw 0x80144060 0x800d00d 
  sw 0x8014405c 0x2 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
 #readPONSerdesReg (0x0800) 0xd00d   # 0x0000      
 #e+99 °C 
*/
 set_serdes_reg(0xd00d, 0x0);
/*                                            
 #writePONSerdesReg  (0x0800) 0xd00d 0x0000 0xffff  
  sw 0x80144060 0x800d00d 
  sw 0x80144064 0x0 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
  sw 0x80144060 0x800d00d 
  sw 0x8014405c 0x2 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0
*/
 set_serdes_reg(0xd00d,0x0);
/* 
 #readPONSerdesReg (0x0800) 0xd00d   # 0x0000      
  sw 0x80144060 0x800d01a 
  sw 0x8014405c 0x2 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
 #readPONSerdesReg (0x0800) 0xd01a   # 0x0000       
  sw 0x80144060 0x800d01a 
  sw 0x8014405c 0x2 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
 #readPONSerdesReg (0x0800) 0xd01a   # 0x0000   
*/
/*    
 #writePONSerdesReg  (0x0800) 0xd0e0 0x0000 0x0001  
  sw 0x80144060 0x800d0e0 
  sw 0x80144064 0xfffe 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x1e000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0e0, 0xfffe);
/*
 #writePONSerdesReg  (0x0800) 0xd070 0x5000 0x7000  
  sw 0x80144060 0x800d070 
  sw 0x80144064 0x50008fff 
  sw 0x8014405c 0x3 
  dw 0x80144068  # 0x12000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd070, 0x50008fff);
/*
 #writePONSerdesReg  (0x0800) 0xd050 0x0002 0x0007  
  sw 0x80144060 0x800d050 
  sw 0x80144064 0x2fff8 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10002      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd050, 0x2fff8);
/*
 #writePONSerdesReg  (0x0800) 0xd0e4 0x0000 0x0000  
  sw 0x80144060 0x800d0e4 
  sw 0x80144064 0x0 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0e4, 0x0);  /* -Vitaly: set to zero */
/*
 #writePONSerdesReg  (0x0800) 0xd070 0x0001 0x0001  
  sw 0x80144060 0x800d070 
  sw 0x80144064 0x0x1fffe
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x15000      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd070, 0x1fffe);
/*
 #writePONSerdesReg  (0x0800) 0xd070 0x0002 0x0002  
  sw 0x80144060 0x800d070 
  sw 0x80144064 0x2fffd 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x15001      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd070, 0x2fffd);
/*
  #writePONSerdesReg  (0x0800) 0xd070 0x2003 0xffff  / * vitaly gpon mode * /
  sw 0x80144060 0x800d070 
  sw 0x80144064 0x20030000 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x15003      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd070, 0x4fffb);
/*
 #writePONSerdesReg  (0x0800) 0xd0e2 0x0000 0x0001  
  sw 0x80144060 0x800d0e2 
  sw 0x80144064 0xfff8 
  sw 0x8014405c 0x3 
  dw 0x80144068   # 0x10002      
  sw 0x8014405c 0x0 
*/
 set_serdes_reg(0xd0e2, 0xfff8); /*  0x1fffe - Mike's original 0xfff8 #Vitaly */
 /*
# Disable dithering for PLLs {0xD0B8 [bit14=ams_pll_ditheren]=0 }
  sw 0x80144060 0x800d0b8 
  sw 0x80144064 0xbfff
  sw 0x8014405c 0x3 
  dw 0x80144068        
  sw 0x8014405c 0x0 
 */
 set_serdes_reg(0xd0b8, 0xbfff); 
}

void  gpon_wan_init(void)
{
    gpon_wan_top_init ();
    gpon_serdes_init ();
} 
